
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‚šì‹œí„°ê°ë³„ê¸° UI</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; max-width: 720px; margin: auto; padding: 40px; background: #f9f9f9; }
    h2 { color: #2c3e50; }
    input, textarea { width: 100%; padding: 10px; margin: 10px 0; border-radius: 4px; border: 1px solid #ccc; }
    button { padding: 10px 16px; border: none; border-radius: 4px; cursor: pointer; }
    #checkBtn { background-color: #4CAF50; color: white; }
    #reportBtn { background-color: #e74c3c; color: white; }
    #checkResult, #aiResult, #reportStatus { margin-top: 15px; padding: 10px; border-radius: 5px; font-size: 15px; }
    #checkResult { background-color: #fff; }
    .danger { color: #e74c3c; font-weight: bold; }
    .warn { color: #f39c12; font-weight: bold; }
    .safe { color: #2ecc71; font-weight: bold; }
    iframe.preview { margin-top: 20px; width: 100%; height: 300px; border: 1px solid #ccc; }
    .http-warning { background: #fff3cd; color: #856404; padding: 10px; border: 1px solid #ffeeba; border-radius: 4px; margin-top: 10px; }
    #logs { margin-top: 20px; font-size: 14px; background: #fff; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h2>ğŸ£ ë‚šì‹œí„°ê°ë³„ê¸°</h2>
  <input id="urlInput" type="text" placeholder="https://example.com">
  <div id="httpWarn" class="http-warning" style="display:none;">âš ï¸ ë³´ì•ˆ ê²½ê³ : HTTPSê°€ ì•„ë‹Œ ë§í¬ì…ë‹ˆë‹¤!</div>
  <button id="checkBtn">ê°ë³„í•˜ê¸°</button>
  <div id="checkResult"></div>
  <div id="aiResult"></div>
  <iframe id="previewFrame" class="preview" style="display:none;"></iframe>

  <h4 style="margin-top:40px;">ğŸš¨ ìˆ˜ìƒí•œ ë§í¬ë¥¼ ë°œê²¬í•˜ì…¨ë‚˜ìš”?</h4>
  <textarea id="reportUrl" placeholder="ì‹ ê³ í•  URL ì…ë ¥"></textarea>
  <button id="reportBtn">ì‹ ê³ í•˜ê¸°</button>
  <div id="reportStatus"></div>

  <button id="loadLogs" style="margin-top:30px; background:#34495e; color:white;">ìµœê·¼ ì‹ ê³ ë‚´ì—­ ë³´ê¸°</button>
  <div id="logs"></div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
const API = 'https://naksiter.onrender.com';

function getColorClass(result) {
  if (result.includes("ìœ„í—˜")) return "danger";
  if (result.includes("ê²½ê³ ") || result.includes("ì£¼ì˜")) return "warn";
  return "safe";
}

$('#checkBtn').click(function() {
  const url = $('#urlInput').val().trim();
  if (!url) return alert("URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");

  $('#checkResult, #aiResult').text("ê°ë³„ ì¤‘...").removeClass().show();
  $('#previewFrame').hide();
  $('#httpWarn').toggle(url.startsWith("http://"));

  $.get(`${API}/check`, { url }).done(data => {
    const cls = getColorClass(data.result);
    $('#checkResult').html(`ğŸ” ê²°ê³¼: <span class="${cls}">${data.result}</span> (ì‹ ê³  ìˆ˜: ${data.ì‹ ê³ ìˆ˜})`);
  });

  $.get(`${API}/preview`, { url }).done(res => {
    $('#aiResult').html("ğŸ§  AI ë¶„ì„: " + res.preview).addClass("safe");
  });

  $('#previewFrame').attr("src", url).show();
});

$('#reportBtn').click(function() {
  const url = $('#reportUrl').val().trim();
  if (!url) return alert("ì‹ ê³ í•  URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
  $.ajax({
    type: "POST",
    url: `${API}/report`,
    contentType: "application/json",
    data: JSON.stringify({ url }),
    success: res => $('#reportStatus').text(res.message)
  });
});

$('#loadLogs').click(function() {
  $.get(`${API}/logs`, data => {
    const html = data.ì‹ ê³ ë‚´ì—­.map(log => `ğŸ•“ ${new Date(log.timestamp * 1000).toLocaleString()} â†’ ${log.url}`).join("<br>");
    $('#logs').html(html || 'ìµœê·¼ ì‹ ê³  ì—†ìŒ');
  });
});
</script>
</body>
</html>
